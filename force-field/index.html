<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Force Field ë³€í™” ë¶„ì„ | íŒŒë€ë©</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/core.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;900&display=swap');
        body { font-family: 'Pretendard', sans-serif; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root">
        <div id="force-app" class="max-w-4xl mx-auto py-10 px-4"></div>
    </div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        function ForceApp() {
            const [step, setStep] = useState(1); // 1: ëª©í‘œ, 2: ì¶”ì§„ë ¥, 3: ì €í•­ë ¥, 4: ê²°ê³¼
            const [goal, setGoal] = useState("");
            const [driving, setDriving] = useState([{ id: 1, text: "ë³€í™”ì˜ í•„ìš”ì„±", power: 3 }]);
            const [restraining, setRestraining] = useState([{ id: 1, text: "ì‹¤íŒ¨ì— ëŒ€í•œ ë‘ë ¤ì›€", power: 3 }]);

            const totalDriving = useMemo(() => driving.reduce((acc, d) => acc + d.power, 0), [driving]);
            const totalRestraining = useMemo(() => restraining.reduce((acc, r) => acc + r.power, 0), [restraining]);

            const updateItem = (list, setList, id, field, val) => {
                setList(list.map(item => item.id === id ? { ...item, [field]: field === 'power' ? parseInt(val) : val } : item));
            };

            const saveAsHtml = () => {
                const htmlContent = `
                    <!DOCTYPE html>
                    <html>
                    <head><meta charset="UTF-8"><title>Force Field ë¶„ì„ ë³´ê³ ì„œ</title><style>body{font-family:sans-serif;padding:40px;max-width:600px;margin:0 auto;}h1{border-bottom:4px solid #2563eb;padding-bottom:10px;}.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}.box{padding:15px;border-radius:10px;border:1px solid #eee;}</style></head>
                    <body>
                        <h1>ğŸš€ Force Field ë³€í™” ë¶„ì„ ë³´ê³ ì„œ</h1>
                        <p><strong>ëª©í‘œí•˜ëŠ” ë³€í™”:</strong> ${goal}</p>
                        <div class="grid">
                            <div class="box" style="background:#eff6ff;"><h3>ì¶”ì§„ë ¥ (Total: ${totalDriving})</h3>${driving.map(d=>`<div>â€¢ ${d.text} (í˜: ${d.power})</div>`).join('')}</div>
                            <div class="box" style="background:#fff1f2;"><h3>ì €í•­ë ¥ (Total: ${totalRestraining})</h3>${restraining.map(r=>`<div>â€¢ ${r.text} (í˜: ${r.power})</div>`).join('')}</div>
                        </div>
                        <div style="margin-top:20px; font-weight:bold; text-align:center; font-size:20px;">
                            ê²°ë¡ : ${totalDriving > totalRestraining ? 'ë³€í™” ì¶”ì§„ ê°€ëŠ¥' : 'ì €í•­ë ¥ ì œê±° í•„ìš”'}
                        </div>
                    </body>
                    </html>
                `;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `force_field_analysis.html`;
                a.click();
            };

            return (
                <div className="animate-in fade-in duration-500">
                    {step === 1 && (
                        <div className="bg-white p-10 rounded-[3rem] shadow-2xl border border-slate-100 max-w-2xl mx-auto">
                            <h2 className="text-3xl font-black text-slate-900 mb-4">ì–´ë–¤ ë³€í™”ë¥¼ ì›í•˜ì‹œë‚˜ìš”?</h2>
                            <p className="text-slate-500 mb-10 font-medium">ì‹œë„í•˜ê³  ì‹¶ì€ ë³€í™”ë‚˜ í•´ê²°í•˜ê³  ì‹¶ì€ ë¬¸ì œë¥¼ ì ì–´ì£¼ì„¸ìš”.</p>
                            <input value={goal} onChange={(e)=>setGoal(e.target.value)} placeholder="ì˜ˆ: ë§¤ì¼ ìƒˆë²½ 5ì‹œ ê¸°ìƒí•˜ê¸°, ìƒˆë¡œìš´ ì‚¬ì—… ì‹œì‘" className="w-full p-6 bg-slate-50 border-4 border-transparent focus:border-blue-500 rounded-[2rem] outline-none text-xl font-black transition-all" />
                            <button onClick={()=>setStep(2)} className="w-full mt-10 py-6 bg-blue-600 text-white rounded-[2rem] font-black text-xl shadow-xl shadow-blue-200">ë¶„ì„ ì‹œì‘í•˜ê¸°</button>
                        </div>
                    )}

                    {step === 2 && (
                        <div className="bg-white p-10 rounded-[3rem] shadow-2xl border border-slate-100">
                            <h2 className="text-3xl font-black text-blue-600 mb-2">ë‚˜ë¥¼ ë°€ì–´ì£¼ëŠ” í˜ (Driving Forces)</h2>
                            <p className="text-slate-500 mb-10 font-medium">ë³€í™”ë¥¼ ì›í•˜ëŠ” ì´ìœ ì™€ ë‚˜ë¥¼ ì›€ì§ì´ê²Œ í•˜ëŠ” ê¸ì •ì  ìš”ì¸ì„ ì ìœ¼ì„¸ìš”.</p>
                            <div className="space-y-4 mb-10">
                                {driving.map((d) => (
                                    <div key={d.id} className="p-6 bg-blue-50 rounded-[2rem] border border-blue-100">
                                        <div className="flex gap-3 mb-4">
                                            <input value={d.text} onChange={(e)=>updateItem(driving, setDriving, d.id, 'text', e.target.value)} className="flex-1 p-3 bg-white rounded-xl outline-none font-bold" />
                                            <button onClick={()=>setDriving(driving.filter(item => item.id !== d.id))} className="text-blue-300">âœ•</button>
                                        </div>
                                        <div className="flex justify-between text-xs font-black text-blue-400 mb-2 uppercase">ì˜í–¥ë ¥: {d.power}ì </div>
                                        <input type="range" min="1" max="5" value={d.power} onChange={(e)=>updateItem(driving, setDriving, d.id, 'power', e.target.value)} className="w-full h-2 bg-blue-200 rounded-full appearance-none cursor-pointer accent-blue-600" />
                                    </div>
                                ))}
                                <button onClick={()=>setDriving([...driving, {id: Date.now(), text: "", power: 3}])} className="text-blue-600 font-black">+ ì¶”ì§„ ìš”ì¸ ì¶”ê°€</button>
                            </div>
                            <button onClick={()=>setStep(3)} className="w-full py-6 bg-blue-600 text-white rounded-[2rem] font-black text-xl shadow-xl shadow-blue-200">ë‹¤ìŒ (ë°©í•´ ìš”ì¸ ì…ë ¥)</button>
                        </div>
                    )}

                    {step === 3 && (
                        <div className="bg-white p-10 rounded-[3rem] shadow-2xl border border-slate-100">
                            <h2 className="text-3xl font-black text-rose-600 mb-2">ë‚˜ë¥¼ ê°€ë¡œë§‰ëŠ” í˜ (Restraining Forces)</h2>
                            <p className="text-slate-500 mb-10 font-medium">ë³€í™”ë¥¼ ë°©í•´í•˜ëŠ” ì¥ì• ë¬¼ì´ë‚˜ ë‘ë ¤ìš´ ì ì„ ì ìœ¼ì„¸ìš”.</p>
                            <div className="space-y-4 mb-10">
                                {restraining.map((r) => (
                                    <div key={r.id} className="p-6 bg-rose-50 rounded-[2rem] border border-rose-100">
                                        <div className="flex gap-3 mb-4">
                                            <input value={r.text} onChange={(e)=>updateItem(restraining, setRestraining, r.id, 'text', e.target.value)} className="flex-1 p-3 bg-white rounded-xl outline-none font-bold" />
                                            <button onClick={()=>setRestraining(restraining.filter(item => item.id !== r.id))} className="text-rose-300">âœ•</button>
                                        </div>
                                        <div className="flex justify-between text-xs font-black text-rose-400 mb-2 uppercase">ë°©í•´ ì •ë„: {r.power}ì </div>
                                        <input type="range" min="1" max="5" value={r.power} onChange={(e)=>updateItem(restraining, setRestraining, r.id, 'power', e.target.value)} className="w-full h-2 bg-rose-200 rounded-full appearance-none cursor-pointer accent-rose-600" />
                                    </div>
                                ))}
                                <button onClick={()=>setRestraining([...restraining, {id: Date.now(), text: "", power: 3}])} className="text-rose-600 font-black">+ ë°©í•´ ìš”ì¸ ì¶”ê°€</button>
                            </div>
                            <div className="flex gap-4">
                                <button onClick={()=>setStep(2)} className="flex-1 py-6 bg-slate-100 text-slate-400 rounded-[2rem] font-black text-xl">ì´ì „</button>
                                <button onClick={()=>setStep(4)} className="flex-1 py-6 bg-blue-600 text-white rounded-[2rem] font-black text-xl shadow-xl shadow-blue-200">ë¶„ì„ ê²°ê³¼ ë³´ê¸°</button>
                            </div>
                        </div>
                    )}

                    {step === 4 && (
                        <div className="bg-white p-10 rounded-[3rem] shadow-2xl border border-slate-100 text-center">
                            <h2 className="text-4xl font-black text-slate-900 mb-2">ë³€í™”ì˜ ì¤„ë‹¤ë¦¬ê¸°</h2>
                            <p className="text-slate-500 mb-12 font-medium">ì¶”ì§„ë ¥ê³¼ ì €í•­ë ¥ì˜ íŒ½íŒ½í•œ ëŒ€ê²° ê²°ê³¼ì…ë‹ˆë‹¤.</p>
                            
                            <div className="relative flex items-center justify-center h-64 mb-12 bg-slate-50 rounded-[3rem] overflow-hidden border-4 border-white shadow-inner">
                                {/* ì¤‘ì•™ì„  */}
                                <div className="absolute left-1/2 top-0 w-1 h-full bg-slate-200 z-10"></div>
                                
                                {/* ì¶”ì§„ë ¥ ë°”ë“¤ (ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ) */}
                                <div className="absolute left-0 w-1/2 flex flex-col items-end gap-2 pr-4">
                                    {driving.map(d => (
                                        <div key={d.id} className="bg-blue-500 h-6 rounded-l-full flex items-center px-4 text-[10px] text-white font-black" style={{ width: `${d.power * 20}%` }}>
                                            {d.text}
                                        </div>
                                    ))}
                                </div>

                                {/* ì €í•­ë ¥ ë°”ë“¤ (ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ) */}
                                <div className="absolute right-0 w-1/2 flex flex-col items-start gap-2 pl-4">
                                    {restraining.map(r => (
                                        <div key={r.id} className="bg-rose-500 h-6 rounded-r-full flex items-center px-4 text-[10px] text-white font-black" style={{ width: `${r.power * 20}%` }}>
                                            {r.text}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className={`p-10 rounded-[2.5rem] mb-10 border-4 ${totalDriving > totalRestraining ? 'border-blue-600 bg-blue-50' : 'border-rose-600 bg-rose-50'}`}>
                                <h3 className={`text-4xl font-black mb-4 ${totalDriving > totalRestraining ? 'text-blue-600' : 'text-rose-600'}`}>
                                    {totalDriving > totalRestraining ? 'ë³€í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”!' : 'ì €í•­ì„ ë¨¼ì € ì¤„ì´ì„¸ìš”!'}
                                </h3>
                                <p className="text-slate-600 font-medium leading-relaxed">
                                    {totalDriving > totalRestraining 
                                        ? "ì¶”ì§„ë ¥ì´ ì €í•­ë ¥ë³´ë‹¤ ê°•í•©ë‹ˆë‹¤. ì§€ê¸ˆì´ ë³€í™”ë¥¼ ì‹¤í–‰í•  ìµœì ì˜ íƒ€ì´ë°ì…ë‹ˆë‹¤." 
                                        : "ì €í•­ë ¥ì´ ë„ˆë¬´ ê°•í•´ ë³€í™”ê°€ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ì§„ë ¥ì„ ë†’ì´ê¸°ë³´ë‹¤ ì €í•­ ìš”ì¸ì„ í•˜ë‚˜ì”© ì œê±°í•˜ëŠ” ê²ƒì´ ë” íš¨ê³¼ì ì…ë‹ˆë‹¤."}
                                </p>
                            </div>

                            <div className="grid grid-cols-1 gap-4">
                                <button onClick={saveAsHtml} className="py-6 bg-slate-900 text-white rounded-[2rem] font-black text-xl shadow-xl">ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ (.html)</button>
                                <button onClick={()=>setStep(1)} className="py-6 bg-slate-100 text-slate-400 rounded-[2rem] font-black text-xl">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('force-app')).render(<ForceApp />);
    </script>
</body>
</html>
